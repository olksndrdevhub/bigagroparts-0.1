{% extends 'base.html' %}
{% load i18n %}

{% block content %}
<main style="margin-top: 100px;">
  <div class="container col-11">
    <div class="display_category_sidebar">
      <div class="title mt-1 mb-1 text-center">
        <h4>{% trans 'Підкатегорія' %}: {{ subcategory.title }}</h4>
        <div class="text-center">
          <img src="{{ subcategory.image.url }}" alt="img" style="height: 320px;" class="">
        </div>
        <div>
          <button class="btn btn-outline-success categories-btn" style="width: 200px;" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
            {% trans 'Всі категорії' %}
          </button>
          <div class="collapse" id="collapseExample">
            <div class="card card-body dm_list">
              {% for category in categories %}
                <a href="{{ category.get_absolute_url }}" class="dropdown-item"><li class="list-group-item">{{ category.title }}</li></a>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
      <section class="text-center mb-5 mt-2">
        <nav class="navbar navbar-expand-lg navbar-dark mdb-color success-color-dark mb-5" style="border-radius: 5px;">    
            <form id="search" action="{% url 'core:search_results' %}" class="form-inline w-100" method="POST">
              {% csrf_token %}
              <div class="md-form my-0 w-100">
                <input class="form-control w-100 m-0" id="q" name="q" type="text" placeholder="{% trans 'Введіть назву запчастини чи її артикул та натисніть Enter' %}" aria-label="Search" title="{% trans 'Намагайтесь вводити точну назву чи артикул' %}">
              </div>
            </form>
          <!-- </div> -->
            <!-- Collapsible content -->
        </nav>

          <!--Grid row-->
        <div class="row mt-5 items_table">
  
          <!--Grid column-->
          
          {% for item in items %}
            <div class="col-6 col-lg-3 col-md-4 col-xl-2 mb-4">
              <div class="card">
                  <div class="card-body">
                    <div class="img-title-box">
                      <a href="{{ item.get_absolute_url }}" class="card-link">
                        <div class="card-img-box">
                          {% with item.itemimage_set.all|first as image %}
                            <img src="{{ image.image.url }}" alt="" class="card-img-top">
                          {% endwith %}
                        </div>
                        <div class="card-title-box">
                          <p>{{ item.title }} <br>
                          <small>{{ item.item_code }}</small></p>
                        </div>
                      </a>  
                    </div>
                    <div class="card-btn-box">
                      <div class="price-cart-wrap">
                        <div class="price-box d-flex align-items-center">
                          {% if item.availability != '0' %}
                            {% if request.user.wholesaler %}
                              <span class="product_page_price">{% trans 'Ціна' %}: ₴ {{ item.wholesaler_price }}</span>
                            {% else %}  
                              <span class="product_page_price">{% trans 'Ціна' %}: ₴ {{ item.price }}</span>
                            {% endif %}
                          {% endif %}
                        </div>
                        <div class="cart-box">
                          {% if item.availability == '1' %}
                            <a href="{{ item.get_add_to_card_url }}" class="btn btn-success btn-lg my-0">
                            <i class="fas fa-shopping-cart"></i>
                            </a>
                          {% else %}
                            <a href="{% url 'core:contacts_page' %}" class="btn btn-warning btn-lg my-0">
                              <i class="far fa-envelope"></i>
                            </a>
                          {% endif %}
                        </div>
                      </div>
                    </div>
                  </div>
              </div>
            </div>
          {% endfor %}
            

        </div>
      </section>
    </div>
  </div>
    
</main>
{% endblock content %}